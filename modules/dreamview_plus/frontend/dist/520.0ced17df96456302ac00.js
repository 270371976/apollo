"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[520],{70907:(e,t,r)=>{r.r(t),r.d(t,{default:()=>P});var n=r(48431),i=r(52016),o=r(15076),a=r(11446),c=r(60016);function l(){return(0,c.f2)((function(e){return{"panel-camera-root":{position:"relative",height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},"camera-btn-container":{position:"absolute",bottom:"24px",right:"24px"},"camera-btn-item":{display:"inline-block",cursor:"pointer",textAlign:"center",width:"32px",height:"32px",lineHeight:"32px",background:"#343C4D",borderRadius:"6px",marginTop:"12px",fontSize:"16px"},"camera-canvas-container":{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%",display:"flex",justifyContent:"center",alignItems:"center"},"panel-camera-canvas":{},"layer-menu-container":{width:"158px",height:"94px"},"layer-menu-header":{height:"40px",paddingLeft:"24px",display:"flex",alignItems:"center",borderBottom:"1px solid #383B45",fontFamily:"PingFangSC-Medium",fontSize:"16px",color:"#FFFFFF",fontWeight:"500"},"layer-menu-content-right":{height:"54px",paddingLeft:"24px",display:"flex",alignItems:"center",fontFamily:"PingFangSC-Regular",fontSize:"14px",color:"#A6B5CC",fontWeight:"400"}}}))()}var u=r(83517),s=new Map([["ST_UNKNOWN","rgba(96, 96, 96, 1.000)"],["ST_UNKNOWN_MOVABLE","rgba(96, 96, 96, 1.000)"],["ST_UNKNOWN_UNMOVABLE","rgba(96, 96, 96, 1.000)"],["ST_CAR","rgba(243, 187, 37, 1.000)"],["ST_VAN","rgba(243, 187, 37, 1.000)"],["ST_TRUCK","rgba(243, 187, 37, 1.000)"],["ST_BUS","rgba(243, 187, 37, 1.000)"],["ST_CYCLIST","rgba(231, 91, 135, 1.000)"],["ST_MOTORCYCLIST","rgba(231, 91, 135, 1.000)"],["ST_TRICYCLIST","rgba(231, 91, 135, 1.000)"],["ST_PEDESTRIAN","#35DACF"],["ST_TRAFFICCONE","#35DACF"]]),f=r(47960),d={"":{boundingbox:{defaultVisible:!1,currentVisible:!1,vizKey:"Boundingbox"}}};function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){var n;return n=function(e,t){if("object"!=h(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==h(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,c=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e){var t=(0,u.d)().panelId,r=e.setShowBoundingBox,o=l(),c=o.classes,s=o.cx,h=(0,f.Bd)("layerMenu").t,p=b((0,n.useState)(d),2),g=p[0],v=p[1],w=b((0,n.useState)((function(){return Object.keys(g)})),1)[0],S=b((0,n.useState)(w[0]),2),O=S[0],E=S[1],x=b((0,n.useState)(g[O]),2),j=x[0],R=x[1],C=(0,a.Mj)("".concat(a.qK.layerMenu).concat(t)),A=(0,a.Mj)("".concat(a.qK.BBox).concat(t));return(0,n.useEffect)((function(){var e=C.get();e&&(v(e),E(w[0]),R(e[w[0]]))}),[]),n.createElement("div",{className:c["layer-menu-container"]},n.createElement("div",{className:c["layer-menu-header"]},n.createElement("div",{className:c["layer-menu-header-left"]},h("layerMenu")),n.createElement("div",{className:c["layer-menu-header-right"]})),n.createElement("div",{className:c["layer-menu-content"]},n.createElement("div",{className:c["layer-menu-content-left"]},w.map((function(e){return n.createElement("li",{key:e,className:s(c["layer-menu-content-left-li"],y({},c["li-active"],O===e)),onClick:function(){E(e),R(g[e])}},n.createElement("span",null,e))}))),n.createElement("div",{className:c["layer-menu-content-right"]},Object.keys(j).map((function(e){var t=g[O][e].currentVisible;return n.createElement("li",{key:e},n.createElement("span",null,n.createElement(i.Sc,{checked:t,defaultChecked:"1"===A.get(),onChange:function(t){var n=t.target.checked;r(n),A.set(n?1:0);var i=m(m({},g[O]),{},y({},e,m(m({},g[O][e]),{},{currentVisible:n}))),o=m(m({},g),{},y({},O,i));R((function(){return i})),v((function(){return o})),C.set(o)}},e)))})))))}const w=n.memo(v);var S=r(46533),O=r(60346),E=r(27878);function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,c=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?R(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C(){var e=(0,u.d)(),t=e.logger,r=e.panelId,c=e.onPanelResize,f=e.initSubscription,d=(0,a.Mj)("".concat(a.qK.BBox).concat(r)),h=j((0,n.useState)((function(){return d.get()})),2),p=h[0],m=h[1],y=j((0,n.useState)(null),2),b=y[0],g=y[1],v=j((0,n.useState)(),2),O=v[0],R=v[1],C=(0,n.useRef)(null);(0,n.useEffect)((function(){var e,t,r,n;f((e={},t=S.lt.CAMERA,r={consumer:function(e){R(e)}},n=function(e,t){if("object"!=x(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==x(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e))}),[]),(0,n.useLayoutEffect)((function(){c((function(e,t){g({viewPortWidth:e,viewPortHeight:t})}))}),[]),(0,n.useEffect)((function(){var e;if(!(0,o.isEmpty)(O)&&(null==O||null===(e=O.image)||void 0===e?void 0:e.length)>0){var n=O.kImageScale,i=new Uint8Array(O.image),a=new Blob([i],{type:"image/jpeg"});createImageBitmap(a).then((function(e){var i=C.current;if(i){var o={},a=e.width/e.height>b.viewPortWidth/b.viewPortHeight,c=b.viewPortWidth/e.width,l=b.viewPortHeight/e.height,u=a?c:l;o.drawImageWidth=e.width*u,o.drawImageHeight=e.height*u,i.width=o.drawImageWidth,i.height=o.drawImageHeight;var f=i.getContext("2d");f.drawImage(e,0,0,o.drawImageWidth,o.drawImageHeight),O.bbox2d&&O.bbox2d.length>0&&p&&(t.debug(r,"has obstacles"),O.bbox2d.forEach((function(e,i){var o=O.obstaclesId[i],a=O.obstaclesSubType[i];f.strokeStyle=s.get(a)||"red";var c=e.xmin,l=e.ymin,d=e.xmax,h=e.ymax;if(c!==l||l!==d||d!==h){var p=j([c,l,d,h].map((function(e){return e*(null!=n?n:1)*u})),4);c=p[0],l=p[1],d=p[2],h=p[3],f.strokeRect(c,l,d-c,h-l),f.fillStyle=s.get(a)||"white",f.font="12px Arial",f.fillText("".concat(a.substring(3),":").concat(o),c,l)}else t.debug(r,"bbox is empty")})))}})).catch((function(e){t.error(e)}))}}),[O,p,b]);var A=l().classes;return n.createElement("div",{className:A["panel-camera-root"]},n.createElement("div",{className:A["camera-btn-container"]},n.createElement(i.AM,{placement:"leftTop",content:n.createElement(w,{setShowBoundingBox:m}),trigger:"click"},n.createElement("span",{className:A["camera-btn-item"]},n.createElement(i.Yx,null)))),n.createElement(E.A,{className:A["camera-canvas-container"]},n.createElement("canvas",{ref:C,id:"camera-".concat(r),className:A["panel-camera-canvas"]})))}function A(e){var t=(0,n.useMemo)((function(){return(0,O.A)({PanelComponent:C,panelId:e.panelId,subscribeInfo:[{name:S.lt.CAMERA,needChannel:!0}]})}),[]);return n.createElement(t,e)}C.displayName="InternalCameraView";const P=n.memo(A)},9117:(e,t,r)=>{r.d(t,{uZ:()=>m});var n=r(48431),i=r(71098),o=r(9738),a=r.n(o),c=r(33005),l=r.n(c),u=function(e,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},u(e,t)};var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var f=function(e,t,r,n){switch(t){case"debounce":return a()(e,r,n);case"throttle":return l()(e,r,n);default:return e}},d=function(e){return"function"==typeof e},h=function(){return"undefined"==typeof window},p=function(e){return e instanceof Element||e instanceof HTMLDocument};function m(e){var t=void 0===e?{}:e,r=t.skipOnMount,i=void 0!==r&&r,o=t.refreshMode,a=t.refreshRate,c=void 0===a?1e3:a,l=t.refreshOptions,u=t.handleWidth,d=void 0===u||u,h=t.handleHeight,p=void 0===h||h,m=t.targetRef,y=t.observerOptions,b=t.onResize,g=(0,n.useRef)(i),v=(0,n.useState)({width:void 0,height:void 0}),w=v[0],S=v[1],O=(0,n.useState)((null==m?void 0:m.current)||null),E=O[0],x=O[1];m&&setTimeout((function(){m.current!==E&&x(m.current)}),0);var j=(0,n.useCallback)((function(e){e!==E&&x(e)}),[E]);j.current=E;var R=(0,n.useCallback)((function(e,t){return(e.width!==t.width||e.height!==t.height)&&!(e.width===t.width&&!p||e.height===t.height&&!d)}),[d,p]),C=(0,n.useCallback)((function(e){(d||p)&&(g.current?g.current=!1:e.forEach((function(e){var t=(null==e?void 0:e.contentRect)||{},r=t.width,n=t.height;S((function(e){return R(e,{width:r,height:n})?{width:r,height:n}:e}))})))}),[d,p,g,R]),A=(0,n.useCallback)(f(C,o,c,l),[C,o,c,l]);return(0,n.useEffect)((function(){var e;return E?(e=new window.ResizeObserver(A)).observe(E,y):(w.width||w.height)&&S({width:void 0,height:void 0}),function(){var t,r,n;null===(t=null==e?void 0:e.disconnect)||void 0===t||t.call(e),null===(n=(r=A).cancel)||void 0===n||n.call(r)}}),[A,E]),(0,n.useEffect)((function(){null==b||b(w.width,w.height)}),[w]),s({ref:j},w)}!function(e){function t(t){var r=e.call(this,t)||this;r.cancelHandler=function(){r.resizeHandler&&r.resizeHandler.cancel&&(r.resizeHandler.cancel(),r.resizeHandler=null)},r.attachObserver=function(){var e=r.props,t=e.targetRef,n=e.observerOptions;if(!h()){t&&t.current&&(r.targetRef.current=t.current);var i=r.getElement();i&&(r.observableElement&&r.observableElement===i||(r.observableElement=i,r.resizeObserver.observe(i,n)))}},r.getElement=function(){var e=r.props,t=e.querySelector,n=e.targetDomEl;if(h())return null;if(t)return document.querySelector(t);if(n&&p(n))return n;if(r.targetRef&&p(r.targetRef.current))return r.targetRef.current;var o=(0,i.findDOMNode)(r);if(!o)return null;switch(r.getRenderType()){case"renderProp":case"childFunction":case"child":case"childArray":return o;default:return o.parentElement}},r.createResizeHandler=function(e){var t=r.props,n=t.handleWidth,i=void 0===n||n,o=t.handleHeight,a=void 0===o||o,c=t.onResize;(i||a)&&e.forEach((function(e){var t=e&&e.contentRect||{},n=t.width,o=t.height;!r.skipOnMount&&!h()&&function(e){var t=e.width,n=e.height;r.state.width===t&&r.state.height===n||r.state.width===t&&!a||r.state.height===n&&!i||(null==c||c(t,n),r.setState({width:t,height:n}))}({width:n,height:o}),r.skipOnMount=!1}))},r.getRenderType=function(){var e=r.props,t=e.render,i=e.children;return d(t)?"renderProp":d(i)?"childFunction":(0,n.isValidElement)(i)?"child":Array.isArray(i)?"childArray":"parent"};var o=t.skipOnMount,a=t.refreshMode,c=t.refreshRate,l=void 0===c?1e3:c,u=t.refreshOptions;return r.state={width:void 0,height:void 0},r.sizeRef={current:r.state},r.skipOnMount=o,r.targetRef=(0,n.createRef)(),r.observableElement=null,h()||(r.resizeHandler=f(r.createResizeHandler,a,l,u),r.resizeObserver=new window.ResizeObserver(r.resizeHandler)),r}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e),t.prototype.componentDidMount=function(){this.attachObserver()},t.prototype.componentDidUpdate=function(){this.attachObserver(),this.sizeRef.current=this.state},t.prototype.componentWillUnmount=function(){h()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},t.prototype.render=function(){var e=this.props,t=e.render,r=e.children,i=e.nodeType,o=void 0===i?"div":i,a=this.state,c={width:a.width,height:a.height,targetRef:this.targetRef};switch(this.getRenderType()){case"renderProp":return null==t?void 0:t(c);case"childFunction":return null==r?void 0:r(c);case"child":var l=r;if(l.type&&"string"==typeof l.type){var u=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(c,["targetRef"]);return(0,n.cloneElement)(l,u)}return(0,n.cloneElement)(l,c);case"childArray":return r.map((function(e){return!!e&&(0,n.cloneElement)(e,c)}));default:return n.createElement(o,null)}}}(n.PureComponent)}}]);